<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Geometric Animation Generator + Capture</title>
<style>
  /* ---- SAME CSS AS BEFORE ---- */
  *{margin:0;padding:0;box-sizing:border-box}
  body{font-family:system-ui;background:linear-gradient(135deg,#1e3c72,#2a5298);color:#fff;overflow-x:hidden}
  .container{max-width:1200px;margin:0 auto;padding:20px}
  header{text-align:center;margin-bottom:30px}
  h1{font-size:2.5em;margin-bottom:10px;text-shadow:2px 2px 4px rgba(0,0,0,.3)}
  .subtitle{font-size:1.2em;opacity:.8}
  .main-content{display:grid;grid-template-columns:300px 1fr;gap:20px;min-height:70vh}
  .controls{background:rgba(255,255,255,.1);backdrop-filter:blur(10px);border-radius:15px;padding:25px;box-shadow:0 8px 32px rgba(0,0,0,.1)}
  .control-group{margin-bottom:20px}label{display:block;margin-bottom:5px;font-weight:600;font-size:.9em}
  input[type=range],select{width:100%;margin-bottom:10px;border-radius:5px;border:none;padding:8px;background:rgba(255,255,255,.2);color:#fff}
  select option{background:#1e3c72}
  .value-display{font-size:.8em;color:#a8d8ff;text-align:right}
  .canvas-container{background:rgba(0,0,0,.3);border-radius:15px;position:relative;overflow:hidden;box-shadow:0 8px 32px rgba(0,0,0,.3)}
  #animationCanvas{width:100%;height:100%;display:block;cursor:crosshair}
  .button-group{display:flex;gap:10px;margin-top:20px}
  button{flex:1;padding:12px;border:none;border-radius:8px;background:linear-gradient(45deg,#667eea,#764ba2);color:#fff;font-weight:600;cursor:pointer;transition:all .3s;box-shadow:0 4px 15px rgba(0,0,0,.2)}
  button:hover{transform:translateY(-2px);box-shadow:0 6px 20px rgba(0,0,0,.3)}
  @media(max-width:768px){.main-content{grid-template-columns:1fr}}
  /* ---- recorder button ---- */
  #recordBtn{position:absolute;top:10px;left:10px;z-index:100;padding:8px 12px;border:none;border-radius:6px;background:#ff6b6b;color:#fff;cursor:pointer}
</style>
</head>
<body>
<div class="container">
  <header><h1>Geometric Animation Generator</h1><p class="subtitle">Create & capture mesmerizing patterns</p></header>
  <div class="main-content">
    <!-- ----- SAME CONTROLS AS BEFORE ----- -->
    <div class="controls">
      <div class="control-group">
        <label for="shapeType">Shape Type</label>
        <select id="shapeType"><option value="circle">Circle</option><option value="square">Square</option><option value="triangle">Triangle</option><option value="hexagon">Hexagon</option><option value="star">Star</option></select>
      </div>
      <div class="control-group"><label for="shapeCount">Shape Count: <span class="value-display" id="shapeCountValue">50</span></label><input type="range" id="shapeCount" min="10" max="200" value="50"></div>
      <div class="control-group"><label for="speed">Speed: <span class="value-display" id="speedValue">2</span></label><input type="range" id="speed" min=".1" max="10" step=".1" value="2"></div>
      <div class="control-group"><label for="size">Size: <span class="value-display" id="sizeValue">30</span></label><input type="range" id="size" min="5" max="100" value="30"></div>
      <div class="control-group"><label for="rotationSpeed">Rotation: <span class="value-display" id="rotationValue">1</span></label><input type="range" id="rotationSpeed" min="0" max="5" step=".1" value="1"></div>
      <div class="control-group"><label for="trail">Trail Effect: <span class="value-display" id="trailValue">0.1</span></label><input type="range" id="trail" min="0" max="1" step=".01" value=".1"></div>
      <div class="control-group">
        <label>Colors</label>
        <input type="color" id="color1" value="#ff6b6b"><input type="color" id="color2" value="#4ecdc4"><input type="color" id="color3" value="#45b7d1">
      </div>
      <div class="button-group"><button onclick="startAnimation()">Start</button><button onclick="pauseAnimation()">Pause</button></div>
      <div class="button-group"><button onclick="resetAnimation()">Reset</button><button onclick="randomizeSettings()">Randomize</button></div>
      <label>Presets</label><div><button onclick="loadPreset('spiral')">Spiral</button><button onclick="loadPreset('wave')">Wave</button><button onclick="loadPreset('burst')">Burst</button><button onclick="loadPreset('orbit')">Orbit</button></div>
    </div>
    <div class="canvas-container">
      <canvas id="animationCanvas"></canvas>
      <button id="recordBtn">Record 7 s MP4</button>
    </div>
  </div>
</div>

<script>
/* --------------- ORIGINAL ANIMATION CODE --------------- */
const canvas=document.getElementById('animationCanvas'),ctx=canvas.getContext('2d');
let animationId,shapes=[],isAnimating=false,globalRotation=0;
const settings={shapeType:'circle',shapeCount:50,speed:2,size:30,rotationSpeed:1,trail:.1,colors:['#ff6b6b','#4ecdc4','#45b7d1']};
function resizeCanvas(){const c=canvas.parentElement;canvas.width=c.clientWidth;canvas.height=c.clientHeight;}
class Shape{constructor(x,y,t,s,c,a,r){this.x=x;this.y=y;this.type=t;this.size=s;this.color=c;this.angle=a;this.radius=r;this.rotation=0;this.opacity=1;this.scale=1;}
update(){this.angle+=settings.speed*.01;this.rotation+=settings.rotationSpeed*.02;this.x=canvas.width/2+Math.cos(this.angle)*this.radius;this.y=canvas.height/2+Math.sin(this.angle)*this.radius;}
draw(){ctx.save();ctx.translate(this.x,this.y);ctx.rotate(this.rotation);ctx.scale(this.scale,this.scale);ctx.globalAlpha=this.opacity;ctx.fillStyle=this.color;ctx.beginPath();switch(this.type){case'circle':ctx.arc(0,0,this.size,0,Math.PI*2);break;case'square':ctx.rect(-this.size,-this.size,this.size*2,this.size*2);break;case'triangle':ctx.moveTo(0,-this.size);ctx.lineTo(-this.size,this.size);ctx.lineTo(this.size,this.size);break;case'hexagon':for(let i=0;i<6;i++){const a=Math.PI*2*i/6,x=Math.cos(a)*this.size,y=Math.sin(a)*this.size;i?ctx.lineTo(x,y):ctx.moveTo(x,y);}break;case'star':for(let i=0;i<10;i++){const r=i%2?this.size/2:this.size,a=Math.PI*i/5,x=Math.cos(a)*r,y=Math.sin(a)*r;i?ctx.lineTo(x,y):ctx.moveTo(x,y);}break;}ctx.fill();ctx.restore();}}
function initializeShapes(){shapes=[];const cx=canvas.width/2,cy=canvas.height/2;for(let i=0;i<settings.shapeCount;i++){const a=Math.PI*2*i/settings.shapeCount,r=50+i*3,c=i%settings.colors.length;shapes.push(new Shape(cx+Math.cos(a)*r,cy+Math.sin(a)*r,settings.shapeType,settings.size*(.5+Math.random()*.5),settings.colors[c],a,r));}}
function animate(){if(!isAnimating)return;ctx.fillStyle=`rgba(0,0,0,${settings.trail})`;ctx.fillRect(0,0,canvas.width,canvas.height);shapes.forEach(s=>{s.update();s.draw();});globalRotation+=settings.rotationSpeed*.01;animationId=requestAnimationFrame(animate);}
function startAnimation(){if(!isAnimating){isAnimating=true;animate();}}
function pauseAnimation(){isAnimating=false;cancelAnimationFrame(animationId);}
function resetAnimation(){pauseAnimation();ctx.clearRect(0,0,canvas.width,canvas.height);initializeShapes();startAnimation();}
function randomizeSettings(){document.getElementById('shapeCount').value=~~(Math.random()*150)+50;document.getElementById('speed').value=(Math.random()*9+1).toFixed(1);document.getElementById('size').value=~~(Math.random()*70)+20;document.getElementById('rotationSpeed').value=(Math.random()*4+1).toFixed(1);document.getElementById('trail').value=(Math.random()*.3+.05).toFixed(2);updateSettings();resetAnimation();}
function loadPreset(p){switch(p){case'spiral':Object.assign(settings,{shapeType:'circle',shapeCount:80,speed:3,size:20,rotationSpeed:2,trail:.05});break;case'wave':Object.assign(settings,{shapeType:'triangle',shapeCount:60,speed:1.5,size:25,rotationSpeed:.5,trail:.2});break;case'burst':Object.assign(settings,{shapeType:'star',shapeCount:100,speed:5,size:15,rotationSpeed:3,trail:.02});break;case'orbit':Object.assign(settings,{shapeType:'hexagon',shapeCount:40,speed:1,size:35,rotationSpeed:1.5,trail:.15});break;}document.getElementById('shapeType').value=settings.shapeType;document.getElementById('shapeCount').value=settings.shapeCount;document.getElementById('speed').value=settings.speed;document.getElementById('size').value=settings.size;document.getElementById('rotationSpeed').value=settings.rotationSpeed;document.getElementById('trail').value=settings.trail;updateSettings();resetAnimation();}
function updateSettings(){settings.shapeType=document.getElementById('shapeType').value;settings.shapeCount=+document.getElementById('shapeCount').value;settings.speed=+document.getElementById('speed').value;settings.size=+document.getElementById('size').value;settings.rotationSpeed=+document.getElementById('rotationSpeed').value;settings.trail=+document.getElementById('trail').value;settings.colors=[document.getElementById('color1').value,document.getElementById('color2').value,document.getElementById('color3').value];document.getElementById('shapeCountValue').textContent=settings.shapeCount;document.getElementById('speedValue').textContent=settings.speed;document.getElementById('sizeValue').textContent=settings.size;document.getElementById('rotationValue').textContent=settings.rotationSpeed;document.getElementById('trailValue').textContent=settings.trail;}
['shapeCount','speed','size','rotationSpeed','trail','color1','color2','color3'].forEach(id=>document.getElementById(id).addEventListener('input',updateSettings));document.getElementById('shapeType').addEventListener('change',()=>{updateSettings();resetAnimation();});
window.addEventListener('resize',()=>{resizeCanvas();initializeShapes();});

/* --------------- 5â€“10 s SCREEN-CAPTURE RECORDER --------------- */
let recorder=null,chunks=[];
function startRecording(sec=7){
  const stream=canvas.captureStream(30);
  chunks=[];
  recorder=new MediaRecorder(stream,{mimeType:'video/webm;codecs=vp9'});
  recorder.ondataavailable=e=>chunks.push(e.data);
  recorder.onstop=()=>{
    const blob=new Blob(chunks,{type:'video/webm'});
    const url=URL.createObjectURL(blob);
    const a=document.createElement('a');
    a.href=url;a.download='geometric-animation.webm';a.click();
    URL.revokeObjectURL(url);
  };
  recorder.start();
  setTimeout(()=>recorder.stop(),sec*1000);
}
document.getElementById('recordBtn').onclick=()=>startRecording(7);

/* --------------- INIT --------------- */
resizeCanvas();updateSettings();initializeShapes();startAnimation();
</script>
</body>
</html>
