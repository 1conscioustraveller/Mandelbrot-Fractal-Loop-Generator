<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Ohm's Law Interactive Circuit</title>

    <!-- TailwindCSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- PyScript -->
    <link rel="stylesheet" href="https://pyscript.net/releases/2024.7.1/core.css">
    <script defer src="https://pyscript.net/releases/2024.7.1/core.js"></script>

    <style>
        body {
            background: radial-gradient(circle at top, #0f172a, #020617);
            color: white;
        }
        .glass {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
    </style>
</head>
<body class="min-h-screen flex items-center justify-center p-4">

    <div class="glass rounded-2xl shadow-2xl max-w-5xl w-full p-8">
        <h1 class="text-center text-4xl font-bold mb-6 tracking-wide text-cyan-400">
            ⚡ Ohm's Law Interactive Circuit
        </h1>

        <div class="flex flex-col lg:flex-row gap-8 items-center justify-center">
            <!-- Python-rendered circuit -->
            <div class="w-full lg:w-2/3 bg-white rounded-xl p-4 shadow-lg">
                <py-config>
                    packages = ["matplotlib"]
                </py-config>

                <py-script>
import math
import matplotlib.pyplot as plt

def draw_battery(ax, x, y, height, spacing):
    ax.plot([x - spacing/2, x - spacing/2], [y - height, y + height])
    ax.plot([x + spacing/2, x + spacing/2], [y - height/2, y + height/2])

def draw_resistor(ax, x1, y1, x2, y2, zigzags=6, amplitude=0.25):
    dx = x2 - x1
    dy = y2 - y1
    length = (dx**2 + dy**2)**0.5
    if length == 0:
        return
    ux, uy = dx/length, dy/length
    px, py = -uy, ux
    pts = [(x1, y1)]
    segment = length / (zigzags * 2)
    for i in range(1, zigzags * 2):
        t = i * segment
        base_x = x1 + ux * t
        base_y = y1 + uy * t
        offset = amplitude if i % 2 == 1 else -amplitude
        pts.append((base_x + px * offset, base_y + py * offset))
    pts.append((x2, y2))
    xs, ys = zip(*pts)
    ax.plot(xs, ys)

class OhmsLawInteractive:
    def __init__(self):
        self.fig, self.ax = plt.subplots(figsize=(6, 4))
        plt.subplots_adjust(left=0.08, right=0.92, top=0.85, bottom=0.26)

        self.V = 9.0
        self.R = 100.0
        self.I = self.V / self.R

        self.left, self.right = -4.0, 4.0
        self.bottom, self.top = -1.5, 1.5

        self.battery_x = self.left
        self.battery_y = 0.0

        self.res_left = 0.0
        self.res_right = self.right
        self.res_y = 0.0

        self._build_canvas()
        self._update()

    def _build_canvas(self):
        ax = self.ax
        ax.clear()
        ax.plot([self.left, self.right], [self.top, self.top])
        ax.plot([self.right, self.right], [self.top, self.bottom])
        ax.plot([self.left, self.right], [self.bottom, self.bottom])
        ax.plot([self.left, self.left], [self.bottom, self.top])

        draw_battery(ax, self.battery_x, self.battery_y, height=0.8, spacing=0.6)
        draw_resistor(ax, self.res_left, self.res_y, self.res_right, self.res_y)

        self.arrow = ax.annotate("", xy=(self.right - 0.5, self.top),
                                 xytext=(self.left + 0.5, self.top),
                                 arrowprops=dict(arrowstyle="->", linewidth=2.0))

        self.text_I = ax.text(0.0, self.top + 0.3, "", ha="center", va="bottom", fontsize=11)
        self.text_V = ax.text(self.left - 0.2, 0.0, "", ha="right", va="center", fontsize=11, rotation=90)
        self.text_R = ax.text(self.res_right + 0.2, self.res_y, "", ha="left", va="center", fontsize=11)
        self.eq_text = ax.text(0.0, self.bottom - 0.4, "", ha="center", va="top", fontsize=12)

        ax.set_facecolor("#f8fafc")
        ax.set_aspect("equal", adjustable="box")
        ax.set_xlim(self.left - 1.5, self.right + 1.5)
        ax.set_ylim(self.bottom - 1.0, self.top + 1.0)
        ax.axis("off")

    def _update(self):
        V, R = self.V, self.R
        I = float('nan') if R <= 0 else V / R
        lw = 1.0 + 4.0 * (0.0 if math.isnan(I) else min(1.0, abs(I)))
        self.arrow.remove()
        self.arrow = self.ax.annotate("", xy=(self.right - 0.5, self.top),
                                      xytext=(self.left + 0.5, self.top),
                                      arrowprops=dict(arrowstyle="->", linewidth=lw))

        self.text_I.set_text(f"I = {self._fmt(I)} A")
        self.text_V.set_text(f"V = {self._fmt(V)} V")
        self.text_R.set_text(f"R = {self._fmt(R)} Ω")
        self.eq_text.set_text(r"$I = \dfrac{V}{R}$")

    @staticmethod
    def _fmt(val):
        if val is None or isinstance(val, float) and (math.isnan(val) or math.isinf(val)):
            return "—"
        if abs(val) >= 100:
            return f"{val:.0f}"
        elif abs(val) >= 10:
            return f"{val:.1f}"
        else:
            return f"{val:.2f}"

app = OhmsLawInteractive()
plt.show()
                </py-script>
            </div>

            <!-- Info panel -->
            <div class="w-full lg:w-1/3 space-y-4">
                <div class="p-4 rounded-lg glass">
                    <h2 class="text-xl font-semibold text-cyan-300">What is Ohm’s Law?</h2>
                    <p class="text-gray-300 mt-2 text-sm">
                        Ohm’s Law defines the relationship between <span class="text-cyan-200">Voltage (V)</span>,
                        <span class="text-cyan-200">Current (I)</span>, and <span class="text-cyan-200">Resistance (R)</span>:
                        <code class="bg-gray-800 text-cyan-300 px-1 py-0.5 rounded">V = I × R</code>.
                    </p>
                </div>

                <div class="p-4 rounded-lg glass">
                    <h2 class="text-xl font-semibold text-cyan-300">Tips</h2>
                    <ul class="list-disc pl-4 text-gray-300 text-sm">
                        <li>Increase resistance to lower current.</li>
                        <li>Voltage directly affects current.</li>
                        <li>Perfect for understanding basic circuits.</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

</body>
</html>
